# Sharaku

ローカルの画像ファイルを管理・閲覧するためのデスクトップアプリケーション。
フォルダをスキャンして画像を登録し、サムネイル付きライブラリとして一覧表示できる。

## 技術スタック

- **フロントエンド**: Svelte 5 + TypeScript + Vite
- **バックエンド**: Rust + Tauri 2
- **データベース**: SQLite（アプリ内蔵）
- **サムネイル**: WebP 形式で DB に保存

## 前提条件

- Node.js
- Rust ツールチェーン（`rustup` でインストール）
- Tauri の[システム依存パッケージ](https://v2.tauri.app/start/prerequisites/)

## セットアップ

```bash
npm install
npm run tauri dev
```

## 使い方

### ライブラリ画面

アプリ起動直後はライブラリ画面が表示される。初回は空の状態。

#### フォルダのスキャン

1. 「フォルダをスキャン」ボタンをクリック
2. 画像が含まれるフォルダを選択
3. フォルダ内の画像ファイルが再帰的に検出され、サムネイルが生成される
4. スキャン中は進捗バーで処理状況が表示される
5. 完了後、ライブラリに登録された画像がグリッド表示される

対応形式: **JPG, JPEG, PNG, GIF, WebP, BMP**

同じパスのファイルは重複登録されない。別のフォルダをスキャンすると、既存のライブラリに追加される。

#### ソート

ツールバーのドロップダウンで並び順を変更できる。

| 選択肢        | 説明                             |
| ------------- | -------------------------------- |
| Date (Newest) | 登録日時の新しい順（デフォルト） |
| Date (Oldest) | 登録日時の古い順                 |
| Title (A-Z)   | タイトル昇順                     |
| Title (Z-A)   | タイトル降順                     |

### ビューア画面

ライブラリでサムネイルをクリックすると、ビューア画面に遷移する。

#### フィットモード

画像の表示サイズを3つのモードで切り替えられる。

| モード       | ボタン | キー | 説明                                   |
| ------------ | ------ | ---- | -------------------------------------- |
| 画面フィット | F      | `f`  | 画面内に収まるように表示（デフォルト） |
| 幅フィット   | W      | `w`  | 横幅に合わせて表示                     |
| 高さフィット | H      | `h`  | 高さに合わせて表示                     |

#### ズーム

- **Ctrl（macOS: Cmd）+ マウスホイール**: 段階的にズーム
- **`+` / `=` キー**: 25% ずつ拡大
- **`-` キー**: 25% ずつ縮小
- **`0` キー**: ズームをリセット（100%）
- 範囲: 25% ～ 400%

ズーム率はヘッダー右端に表示される。

#### ページ送り（複数ページ対応時）

- **← / → キー**: 前後のページに移動
- **◀ / ▶ ボタン**: フッターのボタンでも操作可能

#### ライブラリに戻る

- **Escape キー** または **「← 戻る」ボタン**

### キーボードショートカット一覧（ビューア）

| キー                  | 操作             |
| --------------------- | ---------------- |
| `Escape`              | ライブラリに戻る |
| `←`                   | 前ページ         |
| `→`                   | 次ページ         |
| `+` / `=`             | ズームイン       |
| `-`                   | ズームアウト     |
| `0`                   | ズームリセット   |
| `w`                   | 幅フィット       |
| `h`                   | 高さフィット     |
| `f`                   | 画面フィット     |
| `Ctrl/Cmd + ホイール` | ズーム           |

## データの保存場所

- データベースとアプリ設定は Tauri のアプリデータディレクトリに保存される
  - macOS: `~/Library/Application Support/com.sharaku.viewer/`
- サムネイルは DB 内に WebP 形式（最大 200x280px）で格納される

## 開発

```bash
# 開発サーバー起動（ホットリロード有効）
npm run tauri dev

# 型チェック
npm run check

# Lint
npm run lint

# フォーマット
npm run format
```
